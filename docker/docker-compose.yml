services:
  suricata:
    container_name: suricata
    image: agnusdei1207/suricata:latest
    cap_add:
      - SYS_NICE # 낮은 우선순위 프로세스 허용
      - NET_ADMIN # 네트워크 인터페이스 제어 허용
    volumes:
      - suricata-log:/var/log/suricata # Suricata 로그 저장
      - suricata-config:/etc/suricata:rw # 설정 및 룰 공유
    command:
      - "-c"
      - "/etc/suricata/suricata.yaml"
      - "-i"
      - "eth0"
      - "--af-packet"
      - "--runmode=autofp"
      - "--set=af-packet.0.copy-mode=ips"
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "1"
    networks:
      - tct-network
